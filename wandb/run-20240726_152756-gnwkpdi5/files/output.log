Total Epochs: 3000, Total Iters: 1149000
Iters Per Epoch, Training: 0383, Validation: 023
/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/container.py:435: UserWarning: Setting attributes on ParameterList is not supported.
  warnings.warn("Setting attributes on ParameterList is not supported.")
motion motion_ids ========================+> tensor([[ 869,  900,  333,  748,  207,  129,  597, 1014,   82,  221,  409,  560,
          726,  716,  619,  979,  924,  954,   79,  834,  525,  982,  503,  970,
          956,  251,  923,  971,  675,  459,  785,  234,  860,  726, 1005,  803,
          692,  643,  983,  342,  390,  165,  141,  671,  396,  143,  582,  572,
          930,  315,  455,  732,  940,  750,  949,  499,  794,   91,  409,  401,
          386,   75,  223,  584,  118,  724,  927,  932,  923,  827,  831,  136,
          670,   12,  639,  990,  761,  547,  110,  183,  617,  647,  945,  123,
           25,  477, 1010,  358,  963,  410,  188,  788,  215, 1015,  518,  671,
           33,  863,  752,  131,   29,  135,  699,  258,  436,  110,  726,  785,
          517,  373,  981,  391,  141,  952,  336,  165,  324,  819,  587,  853,
          897,  234,   50,  508,  225,  367,  102,  618,  368,  740,  181,  103,
          100,  740,  366,  304, 1021,  896,  634,  999,  539,  155,  979,  766,
          458,  910,  900,  843,   17,  286,  449,  402,  306,  321,  904,  454,
          543,  534,  552,  116,  675,  645, 1010,  475,    5,  618,  468,  953,
          193,  670,  817,  486,  450,  100,  698, 1023,  591,  125,   11,  591,
          870,  214,  100,  294,  866,  880,  511,  643,  952,  498,  628,  530,
          921,  652,  953,  841]], device='cuda:0')
motion motion_ids ========================+> tensor([[ 967,  353, 1020,  550,  850,  192,  720,  758,  615,  911,  560,  994,
          849,  388,   56,  220,  643,  974,  258,  415,  999,   79,  567,  668,
          756,  581,  168,  124,  295,  526,  200,  993,  486,  321,  230,  721,
          684,  129,   79,  657,  223,  938,  102,  758,  235,  880,   90, 1006,
          944,  882,  332,  576,  247,  120,  576,  841,  547,  117, 1005,  618,
          748,  661,  699,  838,  668,  224,  145,  459,  956,  787,  354,  789,
          147,  866,   86,  242,  417, 1008,   57,  297,  819,  751,  532,  801,
          297,  275,  592,  716,  238,   79,  780,  372,  819,  595,  473,  755,
          802,  926,   37,  693,  276,    5,  678,  633,   58,  649,  526,  397,
          496, 1014,  157,  401,  643,  973,  169,  232,  971,  191,  971,   28,
          790,  214,  509,   47,  536,  133,  900,  379,  170,   51,  169,  333,
          645,  497,   73,  442,  894,   56,  664,  994,  701,   12,  891,  743,
          648,  252,    8,   74,  967,  379,  213,  214,  624,  310,  560,  147,
          358,  924,  135,  375,  520,  934,  152,  656,  716,   48,  636,  560,
          219,  403,  955,  865,  147,  643,  576,  163,  214,   74, 1008,  226,
         1006,  540,  192,  367,  198,  543,  579,  114,  819,  389,  881,  101,
          516,  181,   83,  360]], device='cuda:0')
motion motion_ids ========================+> tensor([[ 942,  929,  639,  235,  503,  889,  665,  180,  958,  152,  567,  924,
         1014,  887,   38, 1017, 1001,  881,  269,  756,  542,  336,  900,  763,
          858,  819,  215,  100,  979,  659,  209,  221,  244,  950,  244,  910,
          161,  518,  375,    8,  819,  867,   41,  245,  731,  850,  300,  214,
          276,  538,  345,  538,  688,  436,  192,  860,  351,  520, 1015,  605,
          442,  234,  681,  169,  710,  511,  735, 1001,  275,  526,  800,  629,
          324,  358,  495,  743,  379,  677,  503,  137, 1016,  168,  380,  891,
          251,  372,  819,  644,  342,  149,  391,   47,  318,   38,  659,  371,
          299,  327,  100,  587,  770,  701,  818,   79,  968,  247,  942,  827,
          410,  417, 1009,  225,  289,  661,  897,  852,  632,  629,    8,  919,
          248,  983,  166,  136,  170,  543,  391,  120,  112,  162,   49,  435,
           29,  395,   44,  569,  277,  666,  344,  867,  535,   84,  116,  103,
          277,  932,  227,   81,  404,  867,  386,  812,  338,  158,  997,   94,
          191,  765,  939,  703,  723,  648,  407,  153,  423,  596,  491,  587,
          766,  747,  436,  471,  854,  577,  379,  490,  686,  113,   48,  125,
          264,  882,  899,  526,  334,  854,  639,  847,  391,  834,  832,  314,
          997,   42,  370,  262]], device='cuda:0')
motion motion_ids ========================+> tensor([[  34,  647,  738,  117,  472,  867,  194,   90,  504,  177,  419,  673,
          265,  932,  410,   68,   33,  386,  648,  646,  891, 1004,  668,  818,
          434,  562,  309,  450,  850,  442,  121,  120,  272,  863,  293,  891,
           74,  152,  182,  924,  376,  149,  152,  157,  756,  221,  391,  344,
          185,  628,  725,  253,  508,   27,  909,  357,   79,  113,  125,  813,
           28,  230,  171,  132,  890,  409,  156,  657,  903, 1004,  365,  277,
          244,  832,  156,  719,  390,  827,   37,  351,  587,  340,  568,  684,
          277,  166,   62,  287,  153,  812,  952,   51,  677,  785,   64,  704,
          942,  727,  899,  538,  905,  399,  276,  538,  175,  400,  179,  681,
          447,  451,  586,  391,   65,  800,  763,   24,  851,  342,  576,  831,
          706,  677,  146,  237,  779,  406,  195,  648,  410,  409,  242,  306,
          381,  292,  770,  598,  943,  899,  479,  112,  812,  471,  793,  993,
          287,   37,  894,  812,  715,  946,  397,  181,  318,  284,  971,  258,
           90,  878,  727,  997,  697,  139,  646,  101,  225,  628,  269,  213,
          845,  447,  260,  265,  387, 1009,  428,  656,  139,  231,  738,  754,
          171,  331,  406,  171,  409,  147,  649,  679,  802,  834,  897,    4,
          524,  983,  397,   82]], device='cuda:0')
motion motion_ids ========================+> tensor([[ 448,  946,  214,  353,  726,  560,  919,  503,  338,  987,  828,  853,
          552,  618,  269,  720,  251,  690,  819,  817,  987,   74,  819,  102,
          647,  657,  388,  526,  657,  993,  594,  567,  205,  301,  993,   81,
          113,  899,  700,  421,   54,  594,  182,  582,  610,  134,  900,  441,
          591,  245,  301,  562,  551,  808,  240,  421,  799,  415,  550,  850,
          478,  598,  643,  282,  276,  635,  758,  263,  605,  516,  950,  191,
          962,  591,  568,  751,  758,  100,  702,  824,  587,  959,  815,  657,
          952,  956,  587,  136,   94,  556,  356,  762,  733,  235,  436,  460,
          156,  379,  611,  147,  342,  900,  258,  734,  468,  765,  557,  620,
           28,  231,  232,  933,  827,  270,  505,  235,  508,  819,  868,  409,
          269,  397,   56,  100,  330,  598,    6,  182,   80,  235,  939,  633,
          336,   33,  773,  855,  886,  652,  828,  841,  130,  335,  993,  628,
          264,  831,  306,  421,  743,  189,   47,  404,  582,  212,  311,  968,
          780,  423, 1007,  102,   50,  616,  763,  204,  499,  562,  695,  141,
          100,    2, 1017, 1022,  868,  787,  997,   91,  321,  146,   46,  867,
          199,   66, 1001,   64,  342,  723,  462,  130,   12,  560,   83,  386,
          693,  693,  530,   26]], device='cuda:0')
motion motion_ids ========================+> tensor([[ 957,   80,  518,  236,  366,  419,  891,   99,   72,  905, 1016,  701,
          416,   45,  123, 1022,  338,  168,  971,  227,  277,  387,  620,  693,
          189,  683,   45,  748,  431,  344,  733,  272,   47,  318,  586,  387,
         1009,  832,  695,  106,  904,  480,   94,   46,  867,  618,  748,  802,
          765,  379,   62,  395,  296,  798,  108,  242,  306,   55,  165,  276,
          512,  108,  133,  231, 1018,  993,  152,  859,  725,  416,  125,  321,
          503,  134,  920,  593,  931,  909,   90,  284,  562,  263,  166,  441,
          156,  864,  720,  920,  347,  638,  335,  654,   85,  652,  131,  135,
            8,  924,  411,  493,  100,  808,  449,  730,   32,  734,  715,  219,
          136,  657,   70,  721,  166,  802,   33,  162,  886, 1015,  277,  934,
          845,   92,  324,  274,  924,  999,  856,  940,  190,  170,  370,  764,
          905,  607,  338,  310,  524,  636,  136, 1013,  932,  503,  832,  940,
          342,  287,  834,  336,  291,  567,  632,  702,  420,  313,  933,    9,
          839,  640,  188,  151,  179,  129,  813,  869,  618,  270,  825,   88,
          451, 1005,  764,   81,  895,  672,  975,  874,  521,  738,  572,  598,
          496,  192,  993,  591,  608, 1021,  927,  716,  704,  835,  100,  893,
          849,  170,  725,  958]], device='cuda:0')
motion motion_ids ========================+> tensor([[   7,  235,  298,  378,  519,  306,   94,  738,    7,  758,  156,  416,
          987,  689,  406,  519,  582,  577,  698,  792,  182,  482,  340,  909,
          818,  419,  515,  624,  372,  342,  942,   24,  693,  773,  757,  379,
            0,  872,  303,  474,  216,  702,  552,  756,  301,  617,  733,  788,
          539,  462,  880,  128,  657,  661,  372,   55,  391,  263,  442,  693,
          698,  242,  314,  956,  333,  472,  135,  494,  643,  547,  269,  342,
          290,  587,  135,  102,  190,  483,  276,  293,  471,  485,  698,  698,
          143,  812,  970,  792,  151,  754,  353,   24,  495,  514,  973,  342,
          500,  358,  813,  291,  281,  619,  861,  336,  416,  970,  324,  318,
          896,  459,  819,   51,  286,  715,  467,  942,   47,  961,  763,  853,
           79,  110,   58,  743,  806,   65,  869,  999,   38,  942,  618,  628,
          808,  462, 1009,  276,  173,  169,  987,  100,  408,   39,  397,  231,
           65,  909,  493,   81,  664,  792,  819,  355,  628,  148,  265,  738,
          247,  148,  983,  338,  214,  652,  158,  839,  531,  687,   23,  389,
          801,  276,  472,  822,  953,  361,  850,  125,  845,  958,  140,  151,
          792,  879,  505,  704,  103,  321,  904,    5,  129,  616,  758,  213,
          991,  352,    6,  760]], device='cuda:0')
motion motion_ids ========================+> tensor([[ 993,  436,  190,  827,  667,  520,  528,  701,  518,  338,  406,  829,
          608,  919,  396,  235,  129,  787,  439,  293,  229,  461,  102,  388,
          235,  412,  458,  138,  630,  740,  280,   56,  304,  404,  390,  741,
          677,  397,  803,  168,   12,  536,  406,  131,  727,   68,  562,  321,
          326,  112,  117,  458,  439,  351,  868,  693,  909,  176,  149,  335,
          560,  847,  832,  715, 1016,  972,  973,  697,  102,  822,  232,  190,
          859,  883,  244, 1015,  206,  226,  956,  784,  603,  881,  442,  876,
          719,  336,  839,  228,  110,  645,  647,  818,  633,  423,  693,    5,
          552,  864,  927,  746,  993,  394,  840,  908,  449,  543,  893,  261,
          657,  638,  390,   51,  526,   72,  704,  166,  135,  562,  251,  144,
          438,  165,  798,  579,  757,  300,  943, 1007,  813,  498,  993,  138,
          905,  357,  589,  242,  519,  933,  822,  794,  182,  511,  449,  145,
          102,  758,  446,  386,   19,  909,  213,  402,  997,  967,  793,  100,
          956,  562,  239,  483,  656,  740,  479,  100,  757,  530,  294,   34,
          845,  642,  330, 1005,    2,  449,  643,  967,  315, 1005,  184,  415,
          451,  900,   12,  446,  936,  850,  230,  526,  604,  276,  542,   27,
          704,  946,  764,  113]], device='cuda:0')
Traceback (most recent call last):
  File "trainers/train_transformotion.py", line 150, in <module>
    trainer.train(train_loader, val_loader, eval_val_loader, eval_wrapper=eval_wrapper, plot_eval=plot_t2m)
  File "/root/Transformotion/trainers/../models/transformers/transformotion_trainer.py", line 153, in train
    plot_func=plot_eval, save_ckpt=False, save_anim=True
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
    return func(*args, **kwargs)
  File "/root/Transformotion/trainers/../utils/eval_t2m.py", line 608, in evaluation_transformer
    pred_pose = trans.generate(clip_text[k:k+1], m_length)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
    return func(*args, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/tools.py", line 42, in inner
    out = fn(model, *args, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/transformotion.py", line 279, in generate
    logits, mems = self.forward(prompt_texts, generated, m_lens, labels=None, mems=None, is_generating=True)
  File "/root/Transformotion/trainers/../models/transformers/transformotion.py", line 198, in forward
    ret, pred_hid = self.seqTransDecoderXL(is_generating, prompt_logits.unsqueeze(0), motion_ids.permute(1, 0), labels.permute(1, 0), *mems)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/transformer_xl_decoder.py", line 620, in forward
    hidden, new_mems = self._forward(is_generate, cond_emb, data, mems=mems)
  File "/root/Transformotion/trainers/../models/transformers/transformer_xl_decoder.py", line 591, in _forward
    self.r_r_bias, dec_attn_mask=dec_attn_mask, mems=mems_i)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/transformer_xl_decoder.py", line 417, in forward
    mems=mems)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/transformer_xl_decoder.py", line 193, in forward
    if attn_mask is not None and attn_mask.any().item():
KeyboardInterrupt