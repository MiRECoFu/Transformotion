Load model epoch:21 iterations:8426
Total Epochs: 3000, Total Iters: 1149000
Iters Per Epoch, Training: 0383, Validation: 023
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
logits==========+>torch.Size([64, 1, 1024])
logits==========+>torch.Size([64, 2, 1024])
logits==========+>torch.Size([64, 3, 1024])
logits==========+>torch.Size([64, 4, 1024])
logits==========+>torch.Size([64, 5, 1024])
logits==========+>torch.Size([64, 6, 1024])
logits==========+>torch.Size([64, 7, 1024])
logits==========+>torch.Size([64, 8, 1024])
logits==========+>torch.Size([64, 9, 1024])
logits==========+>torch.Size([64, 10, 1024])
logits==========+>torch.Size([64, 11, 1024])
logits==========+>torch.Size([64, 12, 1024])
logits==========+>torch.Size([64, 13, 1024])
logits==========+>torch.Size([64, 14, 1024])
logits==========+>torch.Size([64, 15, 1024])
logits==========+>torch.Size([64, 16, 1024])
logits==========+>torch.Size([64, 17, 1024])
logits==========+>torch.Size([64, 18, 1024])
logits==========+>torch.Size([64, 19, 1024])
logits==========+>torch.Size([64, 20, 1024])
logits==========+>torch.Size([64, 21, 1024])
logits==========+>torch.Size([64, 22, 1024])
logits==========+>torch.Size([64, 23, 1024])
logits==========+>torch.Size([64, 24, 1024])
logits==========+>torch.Size([64, 25, 1024])
logits==========+>torch.Size([64, 26, 1024])
logits==========+>torch.Size([64, 27, 1024])
logits==========+>torch.Size([64, 28, 1024])
logits==========+>torch.Size([64, 29, 1024])
/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/container.py:435: UserWarning: Setting attributes on ParameterList is not supported.
  warnings.warn("Setting attributes on ParameterList is not supported.")
logits==========+>torch.Size([64, 30, 1024])
logits==========+>torch.Size([64, 31, 1024])
logits==========+>torch.Size([64, 32, 1024])
logits==========+>torch.Size([64, 33, 1024])
logits==========+>torch.Size([64, 34, 1024])
logits==========+>torch.Size([64, 35, 1024])
logits==========+>torch.Size([64, 36, 1024])
logits==========+>torch.Size([64, 37, 1024])
logits==========+>torch.Size([64, 38, 1024])
logits==========+>torch.Size([64, 39, 1024])
logits==========+>torch.Size([64, 40, 1024])
logits==========+>torch.Size([64, 41, 1024])
logits==========+>torch.Size([64, 42, 1024])
logits==========+>torch.Size([64, 43, 1024])
logits==========+>torch.Size([64, 44, 1024])
logits==========+>torch.Size([64, 45, 1024])
logits==========+>torch.Size([64, 46, 1024])
logits==========+>torch.Size([64, 47, 1024])
logits==========+>torch.Size([64, 48, 1024])
logits==========+>torch.Size([64, 49, 1024])
logits==========+>torch.Size([64, 50, 1024])
logits==========+>torch.Size([64, 51, 1024])
logits==========+>torch.Size([64, 52, 1024])
logits==========+>torch.Size([64, 53, 1024])
logits==========+>torch.Size([64, 54, 1024])
logits==========+>torch.Size([64, 55, 1024])
logits==========+>torch.Size([64, 56, 1024])
logits==========+>torch.Size([64, 57, 1024])
logits==========+>torch.Size([64, 58, 1024])
logits==========+>torch.Size([64, 59, 1024])
logits==========+>torch.Size([64, 60, 1024])
logits==========+>torch.Size([64, 61, 1024])
logits==========+>torch.Size([64, 62, 1024])
logits==========+>torch.Size([64, 63, 1024])
logits==========+>torch.Size([64, 64, 1024])
logits==========+>torch.Size([64, 65, 1024])
logits==========+>torch.Size([64, 66, 1024])
logits==========+>torch.Size([64, 67, 1024])
logits==========+>torch.Size([64, 68, 1024])
logits==========+>torch.Size([64, 69, 1024])
logits==========+>torch.Size([64, 70, 1024])
logits==========+>torch.Size([64, 71, 1024])
logits==========+>torch.Size([64, 72, 1024])
logits==========+>torch.Size([64, 73, 1024])
logits==========+>torch.Size([64, 74, 1024])
logits==========+>torch.Size([64, 75, 1024])
logits==========+>torch.Size([64, 76, 1024])
logits==========+>torch.Size([64, 77, 1024])
logits==========+>torch.Size([64, 78, 1024])
logits==========+>torch.Size([64, 79, 1024])
logits==========+>torch.Size([64, 80, 1024])
logits==========+>torch.Size([64, 81, 1024])
logits==========+>torch.Size([64, 82, 1024])
logits==========+>torch.Size([64, 83, 1024])
logits==========+>torch.Size([64, 84, 1024])
logits==========+>torch.Size([64, 85, 1024])
logits==========+>torch.Size([64, 86, 1024])
logits==========+>torch.Size([64, 87, 1024])
logits==========+>torch.Size([64, 88, 1024])
logits==========+>torch.Size([64, 89, 1024])
logits==========+>torch.Size([64, 90, 1024])
logits==========+>torch.Size([64, 91, 1024])
logits==========+>torch.Size([64, 92, 1024])
logits==========+>torch.Size([64, 93, 1024])
logits==========+>torch.Size([64, 94, 1024])
logits==========+>torch.Size([64, 95, 1024])
logits==========+>torch.Size([64, 96, 1024])
logits==========+>torch.Size([64, 97, 1024])
logits==========+>torch.Size([64, 98, 1024])
logits==========+>torch.Size([64, 99, 1024])
logits==========+>torch.Size([64, 100, 1024])
logits==========+>torch.Size([64, 101, 1024])
logits==========+>torch.Size([64, 102, 1024])
logits==========+>torch.Size([64, 103, 1024])
logits==========+>torch.Size([64, 104, 1024])
logits==========+>torch.Size([64, 105, 1024])
logits==========+>torch.Size([64, 106, 1024])
logits==========+>torch.Size([64, 107, 1024])
logits==========+>torch.Size([64, 108, 1024])
logits==========+>torch.Size([64, 109, 1024])
logits==========+>torch.Size([64, 110, 1024])
logits==========+>torch.Size([64, 111, 1024])
logits==========+>torch.Size([64, 112, 1024])
logits==========+>torch.Size([64, 113, 1024])
logits==========+>torch.Size([64, 114, 1024])
logits==========+>torch.Size([64, 115, 1024])
logits==========+>torch.Size([64, 116, 1024])
logits==========+>torch.Size([64, 117, 1024])
logits==========+>torch.Size([64, 118, 1024])
logits==========+>torch.Size([64, 119, 1024])
logits==========+>torch.Size([64, 120, 1024])
logits==========+>torch.Size([64, 121, 1024])
logits==========+>torch.Size([64, 122, 1024])
logits==========+>torch.Size([64, 123, 1024])
logits==========+>torch.Size([64, 124, 1024])
logits==========+>torch.Size([64, 125, 1024])
logits==========+>torch.Size([64, 126, 1024])
logits==========+>torch.Size([64, 127, 1024])
logits==========+>torch.Size([64, 128, 1024])
logits==========+>torch.Size([64, 129, 1024])
logits==========+>torch.Size([64, 130, 1024])
logits==========+>torch.Size([64, 131, 1024])
logits==========+>torch.Size([64, 132, 1024])
logits==========+>torch.Size([64, 133, 1024])
logits==========+>torch.Size([64, 134, 1024])
logits==========+>torch.Size([64, 135, 1024])
logits==========+>torch.Size([64, 136, 1024])
logits==========+>torch.Size([64, 137, 1024])
logits==========+>torch.Size([64, 138, 1024])
logits==========+>torch.Size([64, 139, 1024])
logits==========+>torch.Size([64, 140, 1024])
logits==========+>torch.Size([64, 141, 1024])
logits==========+>torch.Size([64, 142, 1024])
logits==========+>torch.Size([64, 143, 1024])
logits==========+>torch.Size([64, 144, 1024])
logits==========+>torch.Size([64, 145, 1024])
logits==========+>torch.Size([64, 146, 1024])
logits==========+>torch.Size([64, 147, 1024])
logits==========+>torch.Size([64, 148, 1024])
logits==========+>torch.Size([64, 149, 1024])
logits==========+>torch.Size([64, 150, 1024])
logits==========+>torch.Size([64, 151, 1024])
logits==========+>torch.Size([64, 152, 1024])
logits==========+>torch.Size([64, 153, 1024])
logits==========+>torch.Size([64, 154, 1024])
logits==========+>torch.Size([64, 155, 1024])
logits==========+>torch.Size([64, 156, 1024])
logits==========+>torch.Size([64, 157, 1024])
logits==========+>torch.Size([64, 158, 1024])
logits==========+>torch.Size([64, 159, 1024])
logits==========+>torch.Size([64, 160, 1024])
logits==========+>torch.Size([64, 161, 1024])
logits==========+>torch.Size([64, 162, 1024])
logits==========+>torch.Size([64, 163, 1024])
logits==========+>torch.Size([64, 164, 1024])
logits==========+>torch.Size([64, 165, 1024])
logits==========+>torch.Size([64, 166, 1024])
logits==========+>torch.Size([64, 167, 1024])
logits==========+>torch.Size([64, 168, 1024])
logits==========+>torch.Size([64, 169, 1024])
logits==========+>torch.Size([64, 170, 1024])
logits==========+>torch.Size([64, 171, 1024])
logits==========+>torch.Size([64, 172, 1024])
logits==========+>torch.Size([64, 173, 1024])
logits==========+>torch.Size([64, 174, 1024])
logits==========+>torch.Size([64, 175, 1024])
logits==========+>torch.Size([64, 176, 1024])
logits==========+>torch.Size([64, 177, 1024])
logits==========+>torch.Size([64, 178, 1024])
logits==========+>torch.Size([64, 179, 1024])
logits==========+>torch.Size([64, 180, 1024])
logits==========+>torch.Size([64, 181, 1024])
logits==========+>torch.Size([64, 182, 1024])
logits==========+>torch.Size([64, 183, 1024])
logits==========+>torch.Size([64, 184, 1024])
logits==========+>torch.Size([64, 185, 1024])
logits==========+>torch.Size([64, 186, 1024])
logits==========+>torch.Size([64, 187, 1024])
logits==========+>torch.Size([64, 188, 1024])
logits==========+>torch.Size([64, 189, 1024])
logits==========+>torch.Size([64, 190, 1024])
logits==========+>torch.Size([64, 191, 1024])
logits==========+>torch.Size([64, 192, 1024])
logits==========+>torch.Size([64, 193, 1024])
logits==========+>torch.Size([64, 194, 1024])
logits==========+>torch.Size([64, 195, 1024])
logits==========+>torch.Size([64, 196, 1024])
motion motion_ids ========================+> tensor([[912, 912, 912,  ..., 139, 955, 955],
        [136, 136, 136,  ..., 139, 139, 396],
        [735, 735, 912,  ..., 139, 139, 955],
        ...,
        [799, 799, 799,  ...,  85,  85,  85],
        [652, 652, 652,  ...,   6, 139, 139],
        [136, 136, 136,  ..., 735, 735, 735]], device='cuda:0')
 labels====> tensor([[691, 985, 789,  ..., 350, 350, 350],
        [136, 217, 217,  ..., 996, 996, 996],
        [912,  13,  13,  ..., 427, 427, 586],
        ...,
        [796, 703, 802,  ..., 534, 365, 365],
        [ 93,  93,  93,  ..., 996, 996, 996],
        [760, 562,  40,  ...,  91,  91,  91]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
logits==========+>torch.Size([64, 1, 1024])
logits==========+>torch.Size([64, 2, 1024])
logits==========+>torch.Size([64, 3, 1024])
logits==========+>torch.Size([64, 4, 1024])
logits==========+>torch.Size([64, 5, 1024])
logits==========+>torch.Size([64, 6, 1024])
logits==========+>torch.Size([64, 7, 1024])
logits==========+>torch.Size([64, 8, 1024])
logits==========+>torch.Size([64, 9, 1024])
logits==========+>torch.Size([64, 10, 1024])
logits==========+>torch.Size([64, 11, 1024])
logits==========+>torch.Size([64, 12, 1024])
logits==========+>torch.Size([64, 13, 1024])
logits==========+>torch.Size([64, 14, 1024])
logits==========+>torch.Size([64, 15, 1024])
logits==========+>torch.Size([64, 16, 1024])
logits==========+>torch.Size([64, 17, 1024])
logits==========+>torch.Size([64, 18, 1024])
logits==========+>torch.Size([64, 19, 1024])
logits==========+>torch.Size([64, 20, 1024])
logits==========+>torch.Size([64, 21, 1024])
logits==========+>torch.Size([64, 22, 1024])
logits==========+>torch.Size([64, 23, 1024])
logits==========+>torch.Size([64, 24, 1024])
logits==========+>torch.Size([64, 25, 1024])
logits==========+>torch.Size([64, 26, 1024])
logits==========+>torch.Size([64, 27, 1024])
logits==========+>torch.Size([64, 28, 1024])
logits==========+>torch.Size([64, 29, 1024])
logits==========+>torch.Size([64, 30, 1024])
logits==========+>torch.Size([64, 31, 1024])
logits==========+>torch.Size([64, 32, 1024])
logits==========+>torch.Size([64, 33, 1024])
logits==========+>torch.Size([64, 34, 1024])
logits==========+>torch.Size([64, 35, 1024])
logits==========+>torch.Size([64, 36, 1024])
logits==========+>torch.Size([64, 37, 1024])
logits==========+>torch.Size([64, 38, 1024])
logits==========+>torch.Size([64, 39, 1024])
logits==========+>torch.Size([64, 40, 1024])
logits==========+>torch.Size([64, 41, 1024])
logits==========+>torch.Size([64, 42, 1024])
logits==========+>torch.Size([64, 43, 1024])
logits==========+>torch.Size([64, 44, 1024])
logits==========+>torch.Size([64, 45, 1024])
logits==========+>torch.Size([64, 46, 1024])
Traceback (most recent call last):
  File "trainers/train_transformotion.py", line 150, in <module>
    trainer.train(train_loader, val_loader, eval_val_loader, eval_wrapper=eval_wrapper, plot_eval=plot_t2m)
  File "/root/Transformotion/trainers/../models/transformers/transformotion_trainer.py", line 153, in train
    plot_func=plot_eval, save_ckpt=False, save_anim=True
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
    return func(*args, **kwargs)
  File "/root/Transformotion/trainers/../utils/eval_t2m.py", line 458, in evaluation_mask_transformer
    all_pred_motions = trans.generate(clip_text, m_length, motion_ids, temperature=1)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
    return func(*args, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/tools.py", line 42, in inner
    out = fn(model, *args, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/transformotion.py", line 280, in generate
    logits, mems = self.forward(prompt_texts, generated, m_lens, labels=labels[:, k:k+1], mems=None, is_generating=True)
  File "/root/Transformotion/trainers/../models/transformers/transformotion.py", line 184, in forward
    prompt_logits = self.encode_text(prompt_texts)
  File "/root/Transformotion/trainers/../models/transformers/transformotion.py", line 166, in encode_text
    feat_clip_text = self.clip_model.encode_text(text).float()
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/clip/model.py", line 348, in encode_text
    x = self.transformer(x)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/clip/model.py", line 203, in forward
    return self.resblocks(x)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/container.py", line 117, in forward
    input = module(input)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/clip/model.py", line 190, in forward
    x = x + self.attention(self.ln_1(x))
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/clip/model.py", line 187, in attention
    return self.attn(x, x, x, need_weights=False, attn_mask=self.attn_mask)[0]
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/activation.py", line 985, in forward
    attn_mask=attn_mask)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/functional.py", line 4318, in multi_head_attention_forward
    attn_output = attn_output.transpose(0, 1).contiguous().view(tgt_len, bsz, embed_dim)
KeyboardInterrupt