Load model epoch:21 iterations:8426
Total Epochs: 3000, Total Iters: 1149000
Iters Per Epoch, Training: 0383, Validation: 023
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/nn/modules/container.py:435: UserWarning: Setting attributes on ParameterList is not supported.
  warnings.warn("Setting attributes on ParameterList is not supported.")
motion motion_ids ========================+> tensor([[912, 912, 912,  ..., 139, 955, 955],
        [136, 136, 136,  ..., 139, 139, 396],
        [735, 735, 912,  ..., 139, 139, 955],
        ...,
        [799, 799, 799,  ...,  85,  85,  85],
        [652, 652, 652,  ...,   6, 139, 139],
        [136, 136, 136,  ..., 735, 735, 735]], device='cuda:0')
 labels====> tensor([[691, 985, 789,  ..., 350, 350, 350],
        [136, 217, 217,  ..., 996, 996, 996],
        [912,  13,  13,  ..., 427, 427, 586],
        ...,
        [796, 703, 802,  ..., 534, 365, 365],
        [ 93,  93,  93,  ..., 996, 996, 996],
        [760, 562,  40,  ...,  91,  91,  91]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[799, 799, 799,  ...,   6, 955, 955],
        [783, 136, 136,  ..., 217, 217, 217],
        [613, 613, 613,  ..., 139, 139, 955],
        ...,
        [652, 652, 912,  ..., 912, 912, 912],
        [799, 799, 799,  ..., 202, 202, 202],
        [412, 412, 656,  ..., 251, 251, 251]], device='cuda:0')
 labels====> tensor([[836, 287, 287,  ...,  13,  13,  13],
        [357, 426, 426,  ..., 365, 120, 675],
        [950, 963, 963,  ..., 724, 324, 324],
        ...,
        [909,  29, 202,  ..., 996, 996, 996],
        [735, 735, 735,  ..., 382, 382, 561],
        [202,  93,  93,  ..., 927, 927, 927]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[ 621,  110, 1007,  ...,    6,  139,  955],
        [ 909,  909,  269,  ...,  139,  955,  396],
        [ 463,  799,  799,  ...,  139,  139,  955],
        ...,
        [ 799,  799,  799,  ...,   13,   13,   13],
        [ 652,  652,  652,  ...,   85,   85,   85],
        [ 208,  208,  208,  ...,    6,  139,  139]], device='cuda:0')
 labels====> tensor([[ 696,  933,  803,  ...,  996,  996,  996],
        [ 652,  813,   71,  ...,  996,  996,  996],
        [1009,  942,  985,  ...,  996,  996,  996],
        ...,
        [ 250,  250,  250,  ...,  250,  250,  250],
        [ 501,  501,  501,  ...,  996,  996,  996],
        [ 938,    4,  535,  ...,  571,  653,  893]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[208, 208, 963,  ..., 963, 963, 963],
        [957, 652, 652,  ..., 955, 955, 955],
        [136, 136, 136,  ...,   6, 139, 139],
        ...,
        [130, 130, 130,  ..., 130, 130, 130],
        [136, 136, 719,  ..., 719, 719, 719],
        [799, 799, 799,  ..., 167, 167, 167]], device='cuda:0')
 labels====> tensor([[626, 283,  42,  ..., 976, 286, 286],
        [799, 719, 719,  ..., 996, 996, 996],
        [626, 728, 362,  ..., 518, 906, 960],
        ...,
        [710,  29,  29,  ..., 996, 996, 996],
        [589, 589, 589,  ..., 996, 996, 996],
        [912, 620, 691,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[136, 136, 136,  ..., 217, 217, 217],
        [652, 652, 652,  ..., 139, 139, 955],
        [640, 136, 136,  ...,   6, 139, 139],
        ...,
        [136, 136, 269,  ..., 139, 139, 955],
        [136, 136, 136,  ..., 269, 269, 269],
        [950, 950, 950,  ..., 536, 536, 536]], device='cuda:0')
 labels====> tensor([[136, 719, 719,  ..., 403, 403, 403],
        [799,  93,  93,  ..., 996, 996, 996],
        [101, 101, 101,  ..., 996, 996, 996],
        ...,
        [515, 515, 515,  ..., 996, 996, 996],
        [798, 202, 202,  ..., 996, 996, 996],
        [799,  93,  93,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[799, 799, 799,  ...,   6, 139, 955],
        [799, 799, 799,  ...,  85, 955, 955],
        [136, 136, 136,  ...,   6, 955, 955],
        ...,
        [912, 912, 912,  ..., 139, 139, 139],
        [672, 799, 620,  ...,   6, 139, 139],
        [828, 828, 828,  ..., 139, 955, 955]], device='cuda:0')
 labels====> tensor([[796, 837, 735,  ..., 996, 996, 996],
        [ 64,  64,  64,  ...,   2,   2, 764],
        [583, 980, 980,  ..., 926, 926, 926],
        ...,
        [ 85,  85,  85,  ..., 996, 996, 996],
        [466, 466, 466,  ..., 996, 996, 996],
        [384, 586, 403,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[136, 136, 136,  ..., 139, 139, 396],
        [705, 705, 705,  ..., 139, 139, 139],
        [136, 136, 136,  ..., 217, 217, 217],
        ...,
        [909, 909, 735,  ..., 735, 735, 735],
        [484, 484, 484,  ..., 139, 139, 955],
        [136, 136, 136,  ...,  64,  64,  64]], device='cuda:0')
 labels====> tensor([[1009,  912,  912,  ...,  309,  309,  691],
        [ 804,  804,  684,  ...,  849,  849,  730],
        [ 332,  332,  332,  ...,  996,  996,  996],
        ...,
        [  93,  710,  710,  ...,  996,  996,  996],
        [ 209,  777,  684,  ...,  653,  653,  571],
        [ 250,  250,  250,  ...,  250,  250,  250]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[332, 260, 260,  ...,   6, 139, 955],
        [652, 652, 652,  ..., 912, 912, 912],
        [136, 136, 136,  ..., 726, 726, 726],
        ...,
        [760, 693, 719,  ..., 719, 719, 719],
        [783, 799, 799,  ..., 139, 139, 955],
        [909, 909, 909,  ..., 269, 269, 269]], device='cuda:0')
 labels====> tensor([[450, 893, 893,  ..., 996, 996, 996],
        [803, 545, 308,  ..., 996, 996, 996],
        [ 13,  13,  13,  ..., 700, 700, 700],
        ...,
        [985, 985, 985,  ..., 996, 996, 996],
        [460, 419, 455,  ...,  81, 364, 364],
        [158, 158, 158,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[912, 912, 912,  ..., 139, 139, 955],
        [909, 909, 180,  ..., 269, 269, 269],
        [120, 909, 339,  ..., 339, 339, 339],
        ...,
        [652, 652, 652,  ...,   6, 139, 139],
        [909, 909, 909,  ..., 269, 269, 269],
        [136, 136, 136,  ..., 396, 396, 396]], device='cuda:0')
 labels====> tensor([[796, 978, 978,  ..., 996, 996, 996],
        [735, 726, 619,  ..., 996, 996, 996],
        [228, 704, 259,  ..., 208, 137, 662],
        ...,
        [927, 927, 927,  ..., 996, 996, 996],
        [ 93,  93, 901,  ..., 996, 996, 996],
        [202,  64,  64,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[136, 136, 136,  ...,  64,  64,  64],
        [909, 909, 909,  ..., 269, 269, 269],
        [652, 652, 652,  ..., 912, 912, 912],
        ...,
        [799, 799, 799,  ..., 139, 139, 955],
        [136, 136, 691,  ..., 139, 139, 955],
        [799, 799, 799,  ...,  93,  93,  93]], device='cuda:0')
 labels====> tensor([[384, 347, 347,  ..., 996, 996, 996],
        [208, 339,  36,  ..., 996, 996, 996],
        [136, 730, 691,  ..., 996, 996, 996],
        ...,
        [136, 217, 217,  ..., 996, 996, 996],
        [909, 217, 217,  ..., 996, 996, 996],
        [ 93,  93,  93,  ..., 733, 733, 616]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[377, 445, 494,  ...,   6,   6,   6],
        [ 64, 136, 136,  ...,  64,  64,  64],
        [912, 912, 912,  ..., 633, 912, 912],
        ...,
        [450, 450, 450,  ..., 139, 139, 139],
        [992, 992, 992,  ..., 992, 992, 992],
        [652, 652, 652,  ..., 901, 901, 901]], device='cuda:0')
 labels====> tensor([[652, 901, 901,  ..., 996, 996, 996],
        [799, 954, 954,  ..., 996, 996, 996],
        [793, 482, 309,  ..., 730, 482, 482],
        ...,
        [799, 843,  93,  ..., 996, 996, 996],
        [368, 368, 368,  ..., 996, 996, 996],
        [909, 719, 719,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[652, 652, 652,  ..., 139, 139, 139],
        [481, 481, 481,  ..., 139, 139, 955],
        [136, 136, 136,  ...,   6, 955, 396],
        ...,
        [450, 450, 450,  ..., 139, 955, 955],
        [ 35,  35, 308,  ...,   6, 139, 955],
        [136, 136, 136,  ..., 719, 719, 719]], device='cuda:0')
 labels====> tensor([[269, 217, 217,  ..., 217, 217,  64],
        [595, 595, 587,  ..., 325, 325, 325],
        [101, 101, 101,  ..., 996, 996, 996],
        ...,
        [843, 843, 843,  ..., 996, 996, 996],
        [331, 331, 331,  ..., 331, 331, 307],
        [ 93,  93,  93,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[950, 950, 950,  ..., 139, 139, 955],
        [799, 799, 799,  ..., 139, 955, 955],
        [735, 735, 735,  ..., 139, 139, 955],
        ...,
        [136, 136, 691,  ..., 139, 955, 955],
        [796, 796, 796,  ..., 139, 955, 955],
        [773, 652, 773,  ..., 773, 773, 773]], device='cuda:0')
 labels====> tensor([[843,  93,  93,  ..., 996, 996, 996],
        [339,  36,  29,  ..., 996, 996, 996],
        [131, 806, 915,  ..., 996, 996, 996],
        ...,
        [426, 170, 170,  ..., 996, 996, 996],
        [719, 719, 719,  ..., 996, 996, 996],
        [339,  93,  93,  ..., 821,  98, 975]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[591, 591, 591,  ..., 139, 139, 955],
        [799, 799, 799,  ...,   6, 139, 955],
        [136, 136, 136,  ...,   6, 139, 139],
        ...,
        [332, 332, 332,  ..., 332, 332, 332],
        [796, 796, 796,  ..., 735, 735, 735],
        [136, 136, 719,  ..., 719, 719, 719]], device='cuda:0')
 labels====> tensor([[308, 335, 620,  ..., 453, 453, 577],
        [333, 132, 927,  ..., 925, 819, 819],
        [269, 339, 130,  ..., 996, 996, 996],
        ...,
        [134, 494, 494,  ..., 996, 996, 996],
        [ 64,  64,  13,  ..., 880, 880, 880],
        [396, 676, 676,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[136, 136, 136,  ..., 202, 202, 202],
        [136, 136, 136,  ..., 955, 955, 396],
        [799, 799, 799,  ...,   6, 955, 955],
        ...,
        [508, 508, 508,  ..., 331, 331, 331],
        [873, 873, 873,  ..., 786, 786, 786],
        [136, 136, 843,  ..., 843, 843, 843]], device='cuda:0')
 labels====> tensor([[ 599,  599,    0,  ...,  994,  994,  994],
        [ 208,  338,  584,  ...,  996,  996,  996],
        [ 652,  874,  976,  ...,  996,  996,  996],
        ...,
        [ 112,  112,  112,  ...,  112,  345, 1001],
        [  93,   93,   93,  ...,  996,  996,  996],
        [ 843,  843,  843,  ...,  996,  996,  996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[912, 912, 912,  ..., 139, 139, 955],
        [136, 136, 136,  ...,   6, 955, 955],
        [150,  93,  93,  ...,  93,  93,  93],
        ...,
        [136, 136, 136,  ..., 217, 217, 217],
        [962,  35, 862,  ..., 862, 862, 862],
        [799, 799, 799,  ..., 901, 901, 901]], device='cuda:0')
 labels====> tensor([[1013, 1013,  927,  ...,  849,  626,  342],
        [ 619,  619,  619,  ...,  996,  996,  996],
        [ 844,  101,  844,  ...,  996,  996,  996],
        ...,
        [ 577,  972,  577,  ...,   82,   82,   82],
        [ 307,  572,  307,  ...,  112,  112,  112],
        [ 158,  158,  158,  ...,  996,  996,  996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[799, 799, 799,  ...,   6,   6, 955],
        [912, 912, 912,  ..., 912, 912, 912],
        [652, 652, 652,  ..., 912, 912, 912],
        ...,
        [412, 349, 349,  ..., 277, 277, 277],
        [136, 136, 136,  ..., 139, 139, 955],
        [223, 799, 799,  ..., 139, 139, 139]], device='cuda:0')
 labels====> tensor([[ 96, 530, 728,  ..., 325, 325, 325],
        [139, 289, 869,  ..., 293, 329, 967],
        [562, 858, 753,  ..., 996, 996, 996],
        ...,
        [740, 749, 488,  ..., 996, 996, 996],
        [309, 735, 591,  ..., 996, 996, 996],
        [670, 546, 484,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[339, 799, 799,  ..., 139, 139, 955],
        [796, 796, 796,  ..., 200, 200, 200],
        [746, 799, 799,  ...,  59,  59,  59],
        ...,
        [ 79, 652, 652,  ..., 139, 139, 139],
        [136, 136,  29,  ..., 139, 955, 955],
        [432, 432, 710,  ...,   6, 139, 955]], device='cuda:0')
 labels====> tensor([[136, 339, 339,  ..., 996, 996, 996],
        [ 93, 463, 309,  ..., 996, 996, 996],
        [ 93, 710, 488,  ..., 996, 996, 996],
        ...,
        [735, 217, 217,  ..., 996, 996, 996],
        [912, 901, 901,  ..., 996, 996, 996],
        [466, 466, 466,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[909, 909, 909,  ..., 269, 269, 269],
        [585, 136,  63,  ...,  63,  63,  63],
        [912, 912, 912,  ..., 139, 139, 139],
        ...,
        [765, 765, 765,  ..., 765, 765, 765],
        [291, 291, 291,  ..., 924, 924, 924],
        [450, 450, 450,  ..., 955, 955, 396]], device='cuda:0')
 labels====> tensor([[ 726,  726,  309,  ...,  996,  996,  996],
        [ 844,  832,  832,  ...,  237, 1006, 1006],
        [ 963,  963,  963,  ...,  468,  468, 1016],
        ...,
        [ 912,  912,  912,  ...,  914,  855,  855],
        [ 954,  954,  954,  ...,  996,  996,  996],
        [ 326,  629,  629,  ...,  996,  996,  996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
motion motion_ids ========================+> tensor([[136, 136, 136,  ..., 139, 139, 955],
        [136, 136, 136,  ..., 217, 217, 217],
        [136, 136, 136,  ...,   6,   6, 139],
        ...,
        [136, 136, 136,  ..., 719, 719, 719],
        [136, 136, 136,  ..., 217, 217, 217],
        [652, 652, 652,  ...,  85,  85,  85]], device='cuda:0')
 labels====> tensor([[136, 730, 482,  ..., 309, 309,  29],
        [691, 815, 815,  ..., 996, 996, 996],
        [972, 947, 537,  ..., 468, 468, 117],
        ...,
        [909, 217, 217,  ..., 996, 996, 996],
        [ 85,  85,  85,  ..., 996, 996, 996],
        [136, 269, 269,  ..., 996, 996, 996]], device='cuda:0')
alllllll=======+>all_pred_motions.shape: torch.Size([64, 196, 263])
pose=======+>pose.shape: torch.Size([64, 196, 263])
inp.size(0)====>tensor([], device='cuda:0', size=(0, 64), dtype=torch.int64)
Traceback (most recent call last):
  File "trainers/train_transformotion.py", line 150, in <module>
    trainer.train(train_loader, val_loader, eval_val_loader, eval_wrapper=eval_wrapper, plot_eval=plot_t2m)
  File "/root/Transformotion/trainers/../models/transformers/transformotion_trainer.py", line 153, in train
    plot_func=plot_eval, save_ckpt=False, save_anim=True
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
    return func(*args, **kwargs)
  File "/root/Transformotion/trainers/../utils/eval_t2m.py", line 458, in evaluation_mask_transformer
    all_pred_motions = trans.generate(clip_text, m_length, motion_ids, temperature=1)
  File "/root/miniconda3/envs/transformotion/lib/python3.7/site-packages/torch/autograd/grad_mode.py", line 26, in decorate_context
    return func(*args, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/tools.py", line 42, in inner
    out = fn(model, *args, **kwargs)
  File "/root/Transformotion/trainers/../models/transformers/transformotion.py", line 298, in generate
    generated = torch.cat(res_seq_ids, dim=1)
KeyboardInterrupt